# å…è´¹ä»£ç†è®¢é˜…æœåŠ¡

> è‡ªåŠ¨æŠ“å–ã€æµ‹é€Ÿã€è½¬æ¢æ ¼å¼çš„å…è´¹ä»£ç†è®¢é˜…æœåŠ¡

## åŠŸèƒ½ç‰¹æ€§

- ğŸŒ **å¤šæºæŠ“å–** - è‡ªåŠ¨ä»å¤šä¸ªå…¬å¼€ä»£ç†åˆ—è¡¨æŠ“å–
- âš¡ **åŒé‡æµ‹é€Ÿ** - å»¶è¿Ÿæµ‹è¯• + ä¸‹è½½é€Ÿåº¦æµ‹è¯•
- ğŸŒ **åœ°åŒºè¯†åˆ«** - ä½¿ç”¨ ip-api.com æ‰¹é‡æŸ¥è¯¢ IP åœ°åŒº
- ğŸ“Š **æ™ºèƒ½æ’åº** - ç»¼åˆå»¶è¿Ÿå’Œé€Ÿåº¦è®¡ç®—åˆ†æ•°æ’å
- ğŸ”’ **å®‰å…¨ç­›é€‰** - é»‘åå•è¿‡æ»¤ã€æ’é™¤é«˜é£é™©å›½å®¶
- â° **å®šæ—¶æ›´æ–°** - æ”¯æŒ Cron è‡ªåŠ¨åˆ·æ–°
- ğŸ“± **å¤šæ ¼å¼è¾“å‡º** - æ”¯æŒ Clash / JSON æ ¼å¼

## å¿«é€Ÿå¼€å§‹

### è®¿é—®è®¢é˜…

```
https://your-worker.your-subdomain.workers.dev/
```

### å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `format` | è¾“å‡ºæ ¼å¼ | `clash`(é»˜è®¤), `json` |
| `country` | ç­›é€‰å›½å®¶ | `US`, `JP`, `CN` |
| `limit` | é™åˆ¶æ•°é‡ | `10`, `20` |
| `key` | è®¿é—®å¯†é’¥ | (å¯é€‰) |

### æ¥å£

| è·¯å¾„ | è¯´æ˜ |
|------|------|
| `/` | Clash è®¢é˜… |
| `/?format=json` | JSON æ ¼å¼ |
| `/?update=1` | æ‰‹åŠ¨è§¦å‘æ›´æ–° |
| `/status` | æŸ¥çœ‹çŠ¶æ€å’Œæµ‹è¯•è¯¦æƒ… |

## ä»£ç†å‘½åè§„åˆ™

ä»£ç†æŒ‰ **åœ°åŒº-åˆ†æ•°æ’å** å‘½åï¼š

```
US-01  â†’ ç»¼åˆåˆ†æ•°æœ€é«˜çš„ç¾å›½ä»£ç†
US-02  â†’ åˆ†æ•°ç¬¬äºŒé«˜çš„ç¾å›½ä»£ç†
JP-01  â†’ ç»¼åˆåˆ†æ•°æœ€é«˜çš„æ—¥æœ¬ä»£ç†
...
```

**å¥½å¤„**ï¼šä¸‹æ¬¡æ›´æ–°ååç§°ä¸å˜ï¼Œä½ é€‰ US-01 å°±ä¸ç”¨é‡æ–°é€‰

## éƒ¨ç½²

### 1. åˆ›å»º Worker

1. æ‰“å¼€ [Cloudflare Dashboard](https://dash.cloudflare.com)
2. è¿›å…¥ **Workers** â†’ **åˆ›å»º Worker**
3. åç§°éšæ„ï¼Œå¦‚ `proxy-sub`
4. ç²˜è´´ `worker.js` ä»£ç 
5. ç‚¹ **éƒ¨ç½²**

### 2. åˆ›å»º KV å­˜å‚¨

KV ç”¨äºç¼“å­˜ä»£ç†æ•°æ®ï¼Œå¿…é¡»åˆ›å»ºï¼š

1. å›åˆ° Cloudflare ä¸»é¡µï¼Œæœç´¢ **KV** æˆ–è¿›å…¥ **Workers** â†’ **KV**
2. ç‚¹å‡» **åˆ›å»ºå‘½åç©ºé—´**
3. åç§°å¡« `proxy-cache`ï¼Œåˆ›å»º

### 3. ç»‘å®š KV åˆ° Worker

1. Workers â†’ ä½ çš„ Worker â†’ **è®¾ç½®** â†’ **å˜é‡**
2. æ‰¾åˆ° **KV å‘½åç©ºé—´ç»‘å®š** â†’ **æ·»åŠ ç»‘å®š**
   - **å˜é‡å**: `PROXY_KV`
   - **KV å‘½åç©ºé—´**: é€‰æ‹©åˆšæ‰åˆ›å»ºçš„ `proxy-cache`

### 4. é‡æ–°éƒ¨ç½²

ç»‘å®š KV åç‚¹ **é‡æ–°éƒ¨ç½²**

### 5. é…ç½® GitHub åŒæ­¥ï¼ˆæ¨èï¼‰

1. Worker â†’ **è®¾ç½®** â†’ **Git** â†’ **æ·»åŠ  GitHub ä»“åº“**
2. é€‰æ‹© `yingw/free-proxy-sub`
3. ä»¥åä»£ç æ›´æ–°ä¼šè‡ªåŠ¨éƒ¨ç½²

### 6. é…ç½®å®šæ—¶æ›´æ–°ï¼ˆå¿…é€‰ï¼Œå»ºè®®ï¼‰

1. Worker â†’ **è§¦å‘å™¨** â†’ **æ·»åŠ  Cron è§¦å‘å™¨**
2. å¡«å…¥ `*/15 * * * *`ï¼ˆæ¯15åˆ†é’Ÿï¼‰
   - æ³¨ï¼šæºç«™æ¯10åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ï¼Œå»ºè®®15åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡

## é…ç½®

ç¼–è¾‘ `worker.js`ï¼š

```javascript
const CONFIG = {
  // ========== æ•°æ®æº ==========
  SOURCES: [
    'https://raw.githubusercontent.com/TheSpeedX/PROXY-List/master/http.txt',
  ],
  
  // ========== æµ‹é€Ÿé…ç½® ==========
  TEST_URL: 'https://httpbin.org/get',
  SPEED_TEST_URL: 'https://speed.cloudflare.com/__down?bytes=1000000',
  TIMEOUT: 5000,
  MAX_PER_COUNTRY: 10,
  MAX_CONCURRENT: 20,
  
  // ========== å®‰å…¨è¿‡æ»¤ ==========
  EXCLUDE_COUNTRIES: ['RU', 'CN', 'KP', 'IR', 'SY'],
  BLACKLIST: ['192.168.', '10.', '172.16.', '127.', 'localhost'],
  
  // ========== å…¶ä»– ==========
  API_KEY: '',
  CACHE_TTL: 3600,
};
```

## è¾“å‡ºæ ¼å¼

### JSONï¼ˆæµ‹è¯•è¯¦æƒ…ï¼‰

```json
{
  "totalProxies": 45,
  "testStats": {
    "lastTest": "2026-02-20T06:30:00.000Z",
    "duration": "35000ms",
    "totalFound": 500,
    "totalTested": 480,
    "validCount": 45,
    "failedCount": 435,
    "successRate": "9.4%"
  },
  "testDetails": [
    {
      "server": "1.2.3.4",
      "port": 8080,
      "latency": 120,
      "downloadSpeed": 5.2,
      "country": "US",
      "status": "ok"
    }
  ]
}
```

### Clash è®¢é˜…

```yaml
proxies:
  - name: "US-01"
    type: http
    server: 1.2.3.4
    port: 8080
    latency: 120
    speed: 5.2MB/s
```

## ç›®å½•ç»“æ„

```
free-proxy-sub/
â”œâ”€â”€ worker.js          # ä¸»ä»£ç 
â”œâ”€â”€ wrangler.toml      # éƒ¨ç½²é…ç½®
â”œâ”€â”€ config.example.js  # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ README.md          # è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ DEPLOY.md         # éƒ¨ç½²æŒ‡å—
â””â”€â”€ .gitignore
```

## å‚è€ƒ

- [TheSpeedX/PROXY-List](https://github.com/TheSpeedX/PROXY-List) - ä»£ç†æ•°æ®æº
- [Clash é…ç½®](https://github.com/Dreamacro/clash/wiki/configuration)
- [Cloudflare Workers](https://workers.cloudflare.com/)
